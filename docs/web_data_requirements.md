# 웹 페이지별 데이터 요구사항

> 웹 서비스 기획서 기반 데이터 준비 현황 및 작업 목록

---

## (1) 종목 차트 페이지

| 데이터 | 필드명 | 소스 | 현재 구현 |
|--------|--------|------|-----------|
| **헤더** ||||
| 회사명 | `company_name` | 한투 API / FDR | ✅ |
| 티커 | `ticker` | 입력값 | ✅ |
| **개요 요약** ||||
| 현재가 | `current_price` | 한투 API / FDR | ✅ |
| 전일대비 | `price_change` | 한투 API / FDR | ✅ |
| 등락률 | `change_rate` | 한투 API / FDR | ✅ |
| **차트 데이터** ||||
| 일별 OHLCV | `open, high, low, close, volume` | FDR | ✅ |
| 기간 선택 | 1일/1주/1개월/3개월/1년 | FDR | ✅ |
| **지표 카드** ||||
| PER | `per` | 한투 API / pykrx | ❌ 추가 필요 |
| PBR | `pbr` | 한투 API / pykrx | ❌ 추가 필요 |
| ROE | `roe` | 한투 API / pykrx | ❌ 추가 필요 |
| **기술적 분석** ||||
| RSI | `rsi` | 직접 계산 | ❌ 추가 필요 |
| 추세 (이동평균) | `ma5, ma20, ma60` | 직접 계산 | ❌ 추가 필요 |

---

## (2) 종목 상세 리포트 페이지

| 데이터 | 필드명 | 소스 | 현재 구현 |
|--------|--------|------|-----------|
| **상단 요약** ||||
| 한 줄 요약 | `brief_summary` | Gemini 생성 | ✅ |
| **투자 의견** ||||
| 목표가 | `target_price` | Gemini 생성 | ✅ |
| 리스크 | `risk_factors` | Gemini 생성 | ✅ |
| **섹션별 데이터** ||||
| 요약 탭 | `summary` | Gemini 생성 | ✅ |
| 주가 탭 | `price_analysis` | Gemini 생성 | ✅ |
| 재무 탭 | `financial_analysis` | Gemini 생성 | ❌ 추가 필요 |
| 의견 탭 | `analyst_opinion` | Tavily + Gemini | ✅ |
| **원문 리포트** ||||
| 전체 텍스트 | `full_text` | Gemini 생성 | ✅ |
| **근거 데이터** ||||
| 지표 카드 | PER/PBR/ROE 등 | (1)번과 동일 | ❌ |

---

## (3) 투자 내역 한눈 요약 페이지

| 데이터 | 필드명 | 소스 | 현재 구현 |
|--------|--------|------|-----------|
| **월간 요약** ||||
| 총 수익률 | `total_profit_rate` | 한투 API 계산 | ✅ |
| 총 손익금액 | `total_profit_amount` | 한투 API 계산 | ✅ |
| 총 평가금액 | `total_eval_amount` | 한투 API | ✅ |
| **종목 요약** ||||
| 종목별 수익률 | `by_stock[].profit_rate` | 한투 API 계산 | ✅ |
| 종목별 손익 | `by_stock[].profit_amount` | 한투 API 계산 | ✅ |
| **설명 블록** ||||
| 용어 설명 | `terms_explanation` | 정적 JSON | ❌ 추가 필요 |

---

## (4) 커뮤니티 / 뉴스 반응 요약 페이지

| 데이터 | 필드명 | 소스 | 현재 구현 |
|--------|--------|------|-----------|
| **요약** ||||
| 공시 요약 | `disclosure_summary` | Tavily + Gemini | ⚠️ 부분 구현 |
| 루머 요약 | `rumor_summary` | Tavily + Gemini | ⚠️ 부분 구현 |
| **키워드** ||||
| 주요 키워드 | `keywords[]` | Gemini 추출 | ❌ 추가 필요 |
| **대표 문장** ||||
| 요약 문장 | `highlight_sentences[]` | Gemini 추출 | ❌ 추가 필요 |
| **출처** ||||
| 뉴스 링크 | `news_sources[].url` | Tavily | ✅ |
| 커뮤니티 링크 | `community_sources[].url` | Tavily | ✅ |

---

## 우선순위별 작업 목록

### 🔴 필수 (페이지 렌더링에 필수)

| 작업 | 대상 페이지 | 상태 |
|------|-------------|------|
| PER/PBR/ROE 조회 API 추가 | (1), (2) | ⬜ |
| RSI 계산 함수 추가 | (1) | ⬜ |
| 이동평균선 계산 함수 추가 | (1) | ⬜ |

### 🟡 권장 (UX 향상)

| 작업 | 대상 페이지 | 상태 |
|------|-------------|------|
| 키워드 추출 프롬프트 추가 | (4) | ⬜ |
| 대표 문장 추출 프롬프트 추가 | (4) | ⬜ |
| 용어 설명 JSON 작성 | (3) | ⬜ |
| 재무 분석 섹션 추가 | (2) | ⬜ |

### 🟢 선택 (추후 확장)

| 작업 | 대상 페이지 | 상태 |
|------|-------------|------|
| 공시 데이터 연동 (DART API) | (4) | ⬜ |
| 커뮤니티 직접 크롤링 | (4) | ⬜ |

---

## 데이터 소스 정리

| 소스 | 용도 | 비용 |
|------|------|------|
| 한국투자증권 API | 실시간 시세, 계좌, 거래내역 | 무료 |
| FinanceDataReader (FDR) | 과거 주가 데이터 | 무료 |
| pykrx | PER/PBR/배당률 등 | 무료 |
| Tavily | 뉴스/커뮤니티 검색 | 무료 1000회/월 |
| Gemini | AI 분석/요약 | 무료 (할당량 내) |
